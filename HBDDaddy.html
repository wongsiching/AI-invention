<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Daddy</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Dancing+Script:wght@600&family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #F9F7F2;
            --card-bg: #FFFFFF;
            --accent-gold: #D4AF37;
            --accent-pink: #E8B4B8;
            --text-dark: #4A4036;
            --btn-hover: #C5A028;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Lato', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#E8E0D5 1px, transparent 1px);
            background-size: 20px 20px;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: var(--text-dark);
        }

        /* å¡ç‰‡ä¸»é«” */
        .card-container {
            position: relative;
            width: 380px;
            height: 680px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(74, 64, 54, 0.15);
            overflow: hidden;
            text-align: center;
            display: flex;
            flex-direction: column;
            padding: 20px;
            transition: all 0.5s ease;
        }

        /* è£é£¾æ¡†ç·š */
        .border-deco {
            position: absolute;
            top: 15px; left: 15px; right: 15px; bottom: 15px;
            border: 1px solid var(--accent-gold);
            border-radius: 15px;
            pointer-events: none;
            z-index: 5;
        }

        /* é€šç”¨æ¨™é¡Œ */
        h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            margin: 10px 0;
            color: var(--text-dark);
            line-height: 1.2;
        }

        .instruction {
            font-size: 0.85rem;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            min-height: 20px;
        }

        /* --- ç‹—ç‹—ç…§ç‰‡ (æ ¸å¿ƒè¦–è¦º - å§‹çµ‚å­˜åœ¨) --- */
        .dog-frame-container {
            margin: 20px auto 30px auto;
            position: relative;
            width: 180px;
            height: 180px;
            transition: all 0.5s ease;
        }

        .dog-frame {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 5px solid #fff;
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.25);
            overflow: hidden;
            background-color: #F3E5AB;
            position: relative;
            z-index: 2;
            cursor: pointer; 
            transition: transform 0.1s;
        }

        .dog-frame:active { transform: scale(0.95); }

        .dog-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* é è¨­ç…§ç‰‡ç½®ä¸­ï¼Œå¦‚æœä¸æº–å¯ä»¥æ”¹æˆ top æˆ– bottom */
            object-position: center; 
        }
        
        /* åœ–ç‰‡è¼‰å…¥å¤±æ•—æ™‚çš„æç¤º */
        .img-error-msg {
            display: none;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #eee;
            color: red;
            font-size: 12px;
            justify-content: center;
            align-items: center;
            padding: 10px;
            text-align: center;
        }

        /* --- é é¢åˆ‡æ›æ©Ÿåˆ¶ --- */
        .stage {
            display: none; /* é è¨­éš±è— */
            flex-direction: column;
            align-items: center;
            width: 100%;
            animation: fadeIn 0.8s ease;
            flex-grow: 1;
        }
        .stage.active { display: flex; }

        #start-screen h2 {
            font-size: 2.5rem;
            margin-top: 10px;
        }
        #start-screen span {
            display: block;
            font-size: 1.2rem;
            font-style: italic;
            color: var(--accent-gold);
            margin-top: 5px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- æ–‡å­—å€åŸŸ --- */
        .message-box {
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            line-height: 1.6;
            margin: 10px 0;
            padding: 15px;
            background: rgba(249, 247, 242, 0.6);
            border-radius: 10px;
            width: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* --- æŒ‰éˆ• --- */
        .btn {
            background-color: var(--text-dark);
            color: #fff;
            border: none;
            padding: 12px 35px;
            font-family: 'Lato', sans-serif;
            font-size: 1rem;
            letter-spacing: 1px;
            border-radius: 30px;
            cursor: pointer;
            margin-top: auto;
            margin-bottom: 40px;
            transition: all 0.3s;
            z-index: 10;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .btn:hover { 
            background-color: var(--accent-gold); 
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(212, 175, 55, 0.4);
        }

        /* --- éŠæˆ²å…ƒç´  --- */
        /* Game 1: Beer */
        .beer-target {
            position: absolute;
            font-size: 40px;
            cursor: pointer;
            z-index: 20;
            user-select: none;
            transition: top 0.4s ease-out, left 0.4s ease-out;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));
        }

        /* Game 2: Love Meter */
        .progress-bar-container {
            width: 180px;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff9a9e 0%, #E8B4B8 100%);
            transition: width 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .heart-particle {
            position: absolute;
            color: #E8B4B8;
            font-size: 24px;
            pointer-events: none;
            animation: floatUp 1s forwards;
            z-index: 50;
        }

        /* Game 3: Candle */
        .cake-container {
            font-size: 90px;
            position: relative;
            margin-top: 10px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .cake-container:active { transform: scale(0.95); }
        
        .flame {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 45px;
            filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.6));
            animation: flicker 0.1s infinite alternate;
            transition: opacity 0.5s;
            transform-origin: center bottom;
        }
        .flame.off { opacity: 0; }

        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1) rotate(-2deg); opacity: 1; }
            100% { transform: translateX(-50%) scale(1.1) rotate(2deg); opacity: 0.9; }
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-80px) scale(1.5) rotate(20deg); opacity: 0; }
        }

        canvas { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:99; }
    </style>
</head>
<body>

    <div class="card-container">
        <div class="border-deco"></div>

        <!-- 
           â˜… é€™è£¡è¨­å®šç…§ç‰‡ â˜… 
           æˆ‘å·²ç¶“å°‡æª”åè¨­å®šç‚º 'IMG_5525.jpg'
           è«‹ç¢ºä¿ä½ çš„ç…§ç‰‡æª”åçœŸçš„æ˜¯é€™å€‹ï¼ˆæ³¨æ„å¤§å°å¯«ï¼Œå¦‚æœæ˜¯ IMG_5525.JPG ä¹Ÿè¦æ”¹éä¾†ï¼‰
        -->
        <div class="dog-frame-container" id="dogContainer">
            <div class="dog-frame" onclick="handleDogClick(event)">
                <img src="IMG_5523.jpg" 
                     alt="Cream Dachshund" 
                     onerror="this.style.display='none'; this.parentElement.querySelector('.img-error-msg').style.display='flex'">
                
                <!-- å¦‚æœç…§ç‰‡è®€å–å¤±æ•—ï¼Œæœƒé¡¯ç¤ºé€™å€‹æç¤º -->
                <div class="img-error-msg">
                    ç…§ç‰‡æœªè®€å–<br>è«‹ç¢ºèªæª”åç‚º<br>IMG_5523.jpg<br>ä¸¦æ”¾åœ¨åŒè³‡æ–™å¤¾
                </div>
            </div>
        </div>

        <!-- STAGE 0: å°é¢ Start Screen -->
        <div id="start-screen" class="stage active">
            <h2>Happy Birthday<br><span>to Daddy</span></h2>
            <div style="flex-grow: 1; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                <p style="color: #888; letter-spacing: 1px; line-height: 1.5;">
                    ä¸€ä»½ç‰¹åˆ¥çš„ç”Ÿæ—¥é©šå–œ<br>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•é–‹å§‹
                </p>
            </div>
            <button class="btn" onclick="startGame()">Enter Game &rarr;</button>
        </div>

        <!-- STAGE 1: æŠ“å•¤é…’ -->
        <div id="stage1" class="stage">
            <h2>Challenge 1</h2>
            <p class="instruction">Catch 5 beers! ğŸº</p>
            
            <div class="beer-target" id="beerTarget" onclick="catchBeer()">ğŸº</div>
            
            <div id="msg1" style="display:none; width: 100%; flex-direction: column; align-items: center; height: 100%;">
                <div class="message-box">
                    è¦ªæ„›çš„ Daddy,<br>
                    ç”Ÿæ—¥å¿«æ¨‚ï¼<br>
                    é€™æ˜¯ç¬¬ä¸€æ¯æ…¶ç¥çš„å•¤é…’ï¼
                </div>
                <button class="btn" onclick="nextStage(2)">Next Level &rarr;</button>
            </div>
        </div>

        <!-- STAGE 2: æ‘¸æ‘¸ç‹— -->
        <div id="stage2" class="stage">
            <h2>Challenge 2</h2>
            <p class="instruction">Tap the dog to send Love â¤ï¸</p>
            
            <div class="progress-bar-container">
                <div class="progress-bar" id="loveBar"></div>
            </div>

            <div id="msg2" style="display:none; width: 100%; flex-direction: column; align-items: center; height: 100%;">
                <div class="message-box">
                    è¬è¬ä½ å¹³æ™‚é€™éº¼è¾›è‹¦<br>
                    ç…§é¡§æˆ‘å€‘ï¼Œ<br>
                    æˆ‘å€‘æœ€æ„›ä½ äº†ï¼
                </div>
                <button class="btn" onclick="nextStage(3)">Final Wish &rarr;</button>
            </div>
        </div>

        <!-- STAGE 3: å¹è Ÿç‡­ -->
        <div id="stage3" class="stage">
            <h2>Make a Wish</h2>
            <p class="instruction">Tap the candle 2 times</p>

            <div class="cake-container" onclick="blowCandle()">
                ğŸ‚
                <div class="flame" id="candleFlame">ğŸ”¥</div>
            </div>

            <div id="msg3" style="display:none; width: 100%; flex-direction: column; align-items: center; height: 100%;">
                <div class="message-box" style="font-size: 1.6rem; color: var(--accent-gold); border: 2px dashed var(--accent-gold);">
                    Happy Birthday<br>
                    to the Best Daddy!<br>
                    æ°¸é å¥åº·å¿«æ¨‚ï¼
                </div>
                <div style="font-size: 40px; margin-top: 20px; animation: bounce 2s infinite;">ğŸ‰ğŸ¥‚ğŸ</div>
            </div>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        let currentStage = 0;
        
        let beerCount = 0;
        const beerMax = 5;
        const beerElem = document.getElementById('beerTarget');
        
        let loveCount = 0;
        const loveMax = 8;
        const loveBar = document.getElementById('loveBar');

        let blowCount = 0;
        const blowMax = 2; // è¨­å®šç‚ºå¹2æ¬¡
        const flameElem = document.getElementById('candleFlame');

        function startGame() {
            document.getElementById('start-screen').classList.remove('active');
            document.getElementById('stage1').classList.add('active');
            currentStage = 1;
            moveBeer();
        }

        function nextStage(stageNum) {
            document.querySelector('.stage.active').classList.remove('active');
            const nextStageElem = document.getElementById('stage' + stageNum);
            nextStageElem.classList.add('active');
            currentStage = stageNum;
        }

        function moveBeer() {
            const x = Math.random() * (280) + 20; 
            const y = Math.random() * (250) + 200; 
            beerElem.style.left = x + 'px';
            beerElem.style.top = y + 'px';
        }

        function catchBeer() {
            beerCount++;
            if (beerCount >= beerMax) {
                beerElem.style.display = 'none';
                document.getElementById('msg1').style.display = 'flex';
                document.querySelector('#stage1 .instruction').style.visibility = 'hidden';
            } else {
                moveBeer();
            }
        }

        function handleDogClick(e) {
            if (currentStage !== 2) return;
            if (loveCount >= loveMax) return;

            loveCount++;
            const percent = (loveCount / loveMax) * 100;
            loveBar.style.width = percent + '%';
            
            createHeart(e.clientX, e.clientY);

            if (loveCount >= loveMax) {
                setTimeout(() => {
                    document.getElementById('msg2').style.display = 'flex';
                    document.querySelector('#stage2 .instruction').style.visibility = 'hidden';
                }, 400);
            }
        }

        function createHeart(x, y) {
            const heart = document.createElement('div');
            heart.classList.add('heart-particle');
            heart.innerHTML = 'â¤ï¸';
            const offsetX = (Math.random() - 0.5) * 20;
            heart.style.left = (x + offsetX) + 'px';
            heart.style.top = y + 'px';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 1000);
        }

        function blowCandle() {
            if (blowCount >= blowMax) return;
            
            blowCount++;
            flameElem.style.opacity = 1 - (blowCount / blowMax);
            flameElem.style.transform = "translateX(-50%) skewX(10deg) scale(0.9)";
            setTimeout(() => {
                flameElem.style.transform = "translateX(-50%)";
            }, 200);

            if (blowCount >= blowMax) {
                flameElem.classList.add('off');
                document.querySelector('#stage3 .instruction').innerText = "Wish Granted!";
                
                setTimeout(() => {
                    document.getElementById('msg3').style.display = 'flex';
                    startConfetti();
                }, 500);
            }
        }

        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let confetti = [];
        const confettiCount = 200;
        const colors = ['#D4AF37', '#E8B4B8', '#FFF', '#FFD700'];

        function initConfetti() {
            for (let i = 0; i < confettiCount; i++) {
                confetti.push({
                    color: colors[Math.floor(Math.random() * colors.length)],
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 6 + 4,
                    speed: Math.random() * 3 + 3,
                    angle: Math.random() * 360,
                    rotationSpeed: (Math.random() - 0.5) * 10
                });
            }
        }

        function renderConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((p, i) => {
                p.y += p.speed;
                p.angle += p.rotationSpeed;
                ctx.beginPath();
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle * Math.PI / 180);
                ctx.fillStyle = p.color;
                ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                ctx.restore();
                
                if (p.y > canvas.height) {
                    p.y = -10;
                    p.x = Math.random() * canvas.width;
                }
            });
            requestAnimationFrame(renderConfetti);
        }

        function startConfetti() {
            initConfetti();
            renderConfetti();
        }
        
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
